ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1))
if (connect) {
p <- p + ggplot2::geom_line()
if (shade) {
ymin_val <- min(freq_table$Freq)  # <- key change
p <- p + ggplot2::geom_ribbon(aes(ymin = ymin_val, ymax = Freq), fill = "grey80", alpha = 0.5)
}
}
return(p)
}
if (getRversion() >= "2.15.1") utils::globalVariables(
c("Category", "Freq", "PlotPos")
)
#' @return A \code{ggplot2} object.
#'
#' @examples
#' centered_dotplot(categories, "animal")
#' centered_dotplot(categories, "animal", connect = TRUE)
#' centered_dotplot(categories, "animal", connect = TRUE, shade = TRUE)
#' centered_dotplot(mpg, "manufacturer", scale = "percent")
#'
#' @export
#' @importFrom ggplot2 ggplot aes geom_point geom_line geom_ribbon labs theme_bw theme element_text
centered_dotplot <- function(df,
var,
connect = FALSE,
shade = FALSE,
scale = c("count", "percent")) {
# ---- Input checks ----
if (!is.data.frame(df)) stop("`df` must be a data.frame or tibble.")
if (!is.character(var) || length(var) != 1) stop("`var` must be a single character string.")
if (!var %in% names(df)) stop("`var` must be a column name in `df`.")
if (is.list(df[[var]])) stop("`var` must refer to an atomic (non-list) column.")
scale <- match.arg(scale)
# ---- Frequency table ----
freq_table <- as.data.frame(table(df[[var]]), stringsAsFactors = FALSE)
names(freq_table) <- c("Category", "Freq")
if (nrow(freq_table) < 2) stop("The variable must have at least two categories.")
# ---- Optional scaling ----
if (scale == "percent") freq_table$Freq <- freq_table$Freq / sum(freq_table$Freq) * 100
# ---- Sort by frequency (descending) ----
freq_table <- freq_table[order(-freq_table$Freq), ]
# ---- Centered positioning algorithm ----
f <- nrow(freq_table)
center <- ceiling(f / 2)
positions <- integer(f)
positions[1] <- center
right <- center
left <- center
side <- 1
for (i in 2:f) {
if (side == 1) {
right <- right + 1
positions[i] <- right
} else {
left <- left - 1
positions[i] <- left
}
side <- -side
}
freq_table$PlotPos <- positions
freq_table <- freq_table[order(freq_table$PlotPos), ]
freq_table$Category <- factor(freq_table$Category, levels = freq_table$Category)
# ---- Plot ----
p <- ggplot2::ggplot(freq_table, ggplot2::aes(x = Category, y = Freq, group = 1)) +
ggplot2::geom_point(size = 3) +
ggplot2::labs(x = var, y = ifelse(scale == "percent", "Percentage", "Frequency")) +
ggplot2::theme_bw() +
ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1))
if (connect) {
p <- p + ggplot2::geom_line()
if (shade) {
ymin_val <- min(freq_table$Freq)  # <- key change
p <- p + ggplot2::geom_ribbon(aes(ymin = ymin_val, ymax = Freq), fill = "grey80", alpha = 0.5)
}
}
return(p)
}
#' @param title Optional character string specifying the plot title.
#'
#' @return A \code{ggplot2} object representing the ranked bar plot.
#'
#' @examples
#' ranked_barplot(categories, "animal")
#' ranked_barplot(categories, "animal", scale = "percent")
#'
#' @export
#' @importFrom ggplot2 ggplot aes geom_col labs theme_bw theme element_text
ranked_barplot <- function(df,
var,
scale = c("count", "percent"),
title = NULL) {
# ---- Input checks ----
if (!is.data.frame(df)) {
stop("`df` must be a data.frame or tibble.")
}
if (!is.character(var) || length(var) != 1) {
stop("`var` must be a single character string.")
}
if (!var %in% names(df)) {
stop("`var` must be a column name in `df`.")
}
scale <- match.arg(scale)
# ---- Frequency table ----
freq_table <- as.data.frame(
table(df[[var]]),
stringsAsFactors = FALSE
)
names(freq_table) <- c("Category", "Freq")
if (nrow(freq_table) < 2) {
stop("The variable must have at least two levels.")
}
# ---- Optional scaling ----
if (scale == "percent") {
freq_table$Freq <- freq_table$Freq / sum(freq_table$Freq) * 100
}
# ---- Sort by frequency ----
freq_table <- freq_table[order(-freq_table$Freq), ]
freq_table$Category <- factor(freq_table$Category,
levels = freq_table$Category)
# ---- Plot ----
ggplot2::ggplot(freq_table,
ggplot2::aes(x = Category, y = Freq)) +
ggplot2::geom_col() +
ggplot2::labs(
title = title,
x = var,
y = ifelse(scale == "percent", "Percentage", "Frequency")
) +
ggplot2::theme_bw() +
ggplot2::theme(
axis.text.x = ggplot2::element_text(angle = 45, hjust = 1)
)
}
devtools::document()
rm(list = c("centered_dotplot", "ranked_barplot"))
devtools::document()      # generate Rd files
devtools::build()         # build tar.gz
devtools::check()         # run full check in clean env
library(remotes)
# Load it
library(nomiShape)
#i want to know more about this library
?nomiShape
?centered_barplot
?pareto
?ranked_barplot
centered_barplot(starwars, "species")
centered_dotplot(starwars, "species")
centered_dotplot(starwars, "species", connect = TRUE, shade = TRUE)
vignette(package = "nomiShape")
devtools::build_vignettes()
browseVignettes("nomiShape")# see vignettes
vignette(package = "nomiShape")
categories$animal
table(categories$animal)
unique(categories$animal)
str(animal)
unique(categories$animal)
str(categories)
unique(categories$animal)
animal_names <- c("Canis lupus", "Felis catus", "Equus ferus caballus",
"Bos taurus", "Sus scrofa", "Ovis aries",
"Capra hircus", "Gallus gallus domesticus",
"Anas platyrhynchos domesticus", "Columba livia domestica")
categories$animal <- sample(animal_names, size = nrow(categories), replace = TRUE)
table(categories$animal)
#instead of letters let´s invent some animal names in scientific names
#in
animal_names <- c("SpongeBob SquarePants",
"Patrick Star",
"Squidward Tentacles",
"Mr. Krabs",
"Sandy Cheeks",
"Plankton",
"Gary the Snail",
"Mrs. Puff",
"Pearl Krabs",
"Larry the Lobster",
"King Neptune")
categories$animal <- sample(animal_names, size = nrow(categories), replace = TRUE)
table(categories$animal)
centered_dotplot(categories, "animal", connect = TRUE, shade = TRUE)
#instead of letters let´s invent some animal names in scientific names
#in
animal_names <- c("Sea sponge",
"Starfish",
"Octopus",
"Crab",
"Squirrel",
"Copepod",
"Snail",
"Pufferfish",
"Whale",
"Lobster",
"Sea god")
categories$animal <- sample(animal_names, size = nrow(categories), replace = TRUE)
table(categories$animal)
centered_dotplot(categories, "animal", connect = TRUE, shade = TRUE)
#now let´s have new df "categories2" with frequencies
#that will produce a triangular distribution
categories2 <- data.frame(
animal = animal_names,
freq = c(5, 10, 15, 20, 25, 30, 25, 20, 15, 10, 5)
)
centered_dotplot(categories2, "animal", connect = TRUE, shade = TRUE)
categories2 <- data.frame(
animal = c(
"Sea sponge",
"Starfish",
"Octopus",
"Crab",
"Snail",
"Pufferfish",
"Whale",
"Lobster",
"Copepod"
),
freq = c(2, 4, 6, 8, 10, 8, 6, 4, 2)
)
categories2 <- categories2[rep(seq_len(nrow(categories2)), categories2$freq), ]
rownames(categories2) <- NULL
table(categories2$animal)
centered_dotplot(categories2, "animal", connect = TRUE, shade = TRUE)
categories2 <- data.frame(
animal = c(
"Sea sponge",
"Starfish",
"Octopus",
"Crab",
"Squirrel",
"Copepod",
"Snail",
"Pufferfish",
"Whale",
"Lobster",
"Sea god"
),
freq = c(2, 4, 6, 8, 10, 12, 10, 8, 6, 4, 2)
)
categories2 <- categories2[rep(seq_len(nrow(categories2)), categories2$freq), ]
rownames(categories2) <- NULL
str(categories2)
table(categories2$animal)
centered_dotplot(categories2, "animal", connect = TRUE, shade = TRUE)
centered_dotplot(categories2, "animal")
centered_barplot(categories2, "animal")
categories2 <- data.frame(
animal = c(
"Sea sponge",
"Starfish",
"Octopus",
"Crab",
"Squirrel",
"Copepod",
"Snail",
"Pufferfish",
"Whale",
"Lobster",
"Sea god"
),
freq = c(2, 4, 6, 8, 10, 12, 10, 8, 6, 4, 2)
)
categories2 <- categories2[rep(seq_len(nrow(categories2)), categories2$freq), ]
rownames(categories2) <- NULL
str(categories2)
table(categories2$animal)
centered_dotplot(categories2, "animal", connect = TRUE, shade = TRUE)
centered_barplot(categories2, "animal")
categories2 <- data.frame(
animal = c(
"Sea sponge",
"Starfish",
"Octopus",
"Crab",
"Squirrel",
"Copepod",
"Snail",
"Pufferfish",
"Whale",
"Lobster",
"Sea god"
),
freq = c(2, 3, 5, 7, 10, 12, 11, 9, 7, 5, 3)
)
categories2 <- categories2[rep(seq_len(nrow(categories2)), categories2$freq), ]
rownames(categories2) <- NULL
str(categories2)
table(categories2$animal)
centered_dotplot(categories2, "animal", connect = TRUE, shade = TRUE)
centered_barplot(categories2, "animal")
# Dominance / exponential (Pareto-like) nominal distribution
categories3 <- data.frame(
animal = c(
"Sea sponge",
"Starfish",
"Octopus",
"Crab",
"Squirrel",
"Copepod",
"Snail",
"Pufferfish",
"Whale",
"Lobster",
"Sea god"
),
freq = c(40, 22, 10, 6, 4, 3, 2, 1, 1, 1, 1)
)
# Convert to long format
categories3_long <- categories3[
rep(seq_len(nrow(categories3)), categories3$freq),
"animal",
drop = FALSE
]
# Convert to long format
categories3 <- categories3[
rep(seq_len(nrow(categories3)), categories3$freq),
"animal",
drop = FALSE
]
head(categories3)
rownames(categories3) <- NULL
head(categories3)
centered_barplot(categories3, "animal")
centered_dotplot(categories3, "animal", connect = TRUE, shade = TRUE)
centered_barplot(categories3, "animal")
# Dominance / exponential (Pareto-like) nominal distribution
categories3 <- data.frame(
animal = c(
"Sea sponge",
"Starfish",
"Octopus",
"Crab",
"Squirrel",
"Copepod",
"Snail",
"Pufferfish",
"Whale",
"Lobster",
"Sea god"
),
freq = c(50, 22, 9, 6, 4, 3, 2, 1, 1, 1, 1)
)
# Convert to long format
categories3 <- categories3[
rep(seq_len(nrow(categories3)), categories3$freq),
"animal",
drop = FALSE
]
rownames(categories3) <- NULL
centered_barplot(categories3, "animal")
centered_dotplot(categories3, "animal", connect = TRUE, shade = TRUE)
centered_barplot(categories3, "animal")
# Dominance / exponential (Pareto-like) nominal distribution
categories3 <- data.frame(
animal = c(
"Sea sponge",
"Starfish",
"Octopus",
"Crab",
"Squirrel",
"Copepod",
"Snail",
"Pufferfish",
"Whale",
"Lobster",
"Sea god"
),
freq = c(50, 38, 9, 6, 4, 3, 2, 1, 1, 1, 1)
)
# Convert to long format
categories3 <- categories3[
rep(seq_len(nrow(categories3)), categories3$freq),
"animal",
drop = FALSE
]
rownames(categories3) <- NULL
centered_barplot(categories3, "animal")
centered_dotplot(categories3, "animal", connect = TRUE, shade = TRUE)
pareto(categories3, "animal")
# Dominance / exponential (Pareto-like) nominal distribution
categories3 <- data.frame(
animal = c(
"Sea sponge",
"Starfish",
"Octopus",
"Crab",
"Squirrel",
"Copepod",
"Snail",
"Pufferfish",
"Whale",
"Lobster",
"Sea god"
),
freq = c(59, 48, 9, 6, 4, 3, 2, 1, 1, 1, 1)
)
# Convert to long format
categories3 <- categories3[
rep(seq_len(nrow(categories3)), categories3$freq),
"animal",
drop = FALSE
]
rownames(categories3) <- NULL
centered_barplot(categories3, "animal")
centered_dotplot(categories3, "animal", connect = TRUE, shade = TRUE)
pareto(categories3, "animal")
# Dominance / exponential (Pareto-like) nominal distribution
categories3 <- data.frame(
animal = c(
"Sea sponge",
"Starfish",
"Octopus",
"Crab",
"Squirrel",
"Copepod",
"Snail",
"Pufferfish",
"Whale",
"Lobster",
"Sea god"
),
freq = c(69, 58, 9, 6, 4, 3, 2, 1, 1, 1, 1)
)
# Convert to long format
categories3 <- categories3[
rep(seq_len(nrow(categories3)), categories3$freq),
"animal",
drop = FALSE
]
rownames(categories3) <- NULL
centered_barplot(categories3, "animal")
centered_dotplot(categories3, "animal", connect = TRUE, shade = TRUE)
pareto(categories3, "animal")
# categories already exists — overwrite if updated
usethis::use_data(categories, overwrite = TRUE)
# add new datasets
usethis::use_data(categories2, categories3, overwrite = TRUE)
devtools::document()   # rebuild Rd files from roxygen2
library(nomiShape)
# Example usage of ranked_barplot
ranked_barplot(categories, "animal")
# Example usage of ranked_dotplot
ranked_dotplot(categories, "animal", connect = TRUE)
# Example usage of ranked_barplot
ranked_barplot(categories2, "animal")
# Example usage of ranked_barplot
ranked_barplot(categories3, "animal")
# Example usage of ranked_dotplot
ranked_dotplot(categories2, "animal", connect = TRUE, shade = TRUE)
# Example usage of ranked_dotplot
ranked_dotplot(categories3, "animal", connect = FALSE, shade = TRUE)
# Example usage of pareto
pareto(categories3, "animal")
# Example usage of centered_barplot
centered_barplot(categories2, "animal",scale = "percent")
# Example usage of centered_barplot
centered_barplot(categories3, "animal")
# Example usage of centered_dotplot
centered_dotplot(categories, "animal",connect = TRUE,shade = TRUE)
# Example usage of centered_dotplot
centered_dotplot(categories2, "animal",connect = TRUE,shade = TRUE)
```{r centered-dotplot-example}
# Example usage of centered_dotplot
centered_dotplot(categories3, "animal",connect = FALSE,shade = TRUE)
# Example usage of centered_dotplot
centered_dotplot(categories3, "animal",connect = F,shade = TRUE)
# Example usage of centered_dotplot
centered_dotplot(categories3, "animal",shade = TRUE)
# Example usage of centered_dotplot
centered_dotplot(categories3, "animal",connect = TRUE,shade = TRUE)
document()
document()# Generate documentation
use_r("categories2")
use_r("categories3")
use_r("categories")
document()
use_r("categories3")
document()
document()
# Load it
library(nomiShape)
#i want to know more about this library
?nomiShape
?centered_barplot
?pareto
?ranked_barplot
vignette(package = "nomiShape")
centered_barplot(starwars, "species")
centered_dotplot(starwars, "species", connect = TRUE, shade = TRUE)
centered_barplot(starwars, "eye_color")
centered_barplot(categories2, "animal")
#what libraries are in here?
data()
vignette(package = "nomiShape")
ranked_barplot(categories2, "animal")
ranked_dotplot(categories2, "animal")
ranked_dotplot(categories2, "animal", connect = TRUE)
ranked_dotplot(categories2, "animal", connect = TRUE, scale = "percent",
shaded = TRUE)
ranked_dotplot(categories2, "animal", connect = TRUE, scale = "percent",
shaded = TRUE)
ranked_dotplot(categories2, "animal", connect = TRUE,
shaded = TRUE)
centered_dotplot(categories2, "animal", connect = TRUE, shade = TRUE)
centered_barplot(categories2, "animal")
pareto(categories3, "animal")
centered_barplot(categories2, "animal")
centered_barplot(categories1, "animal")
centered_barplot(categories1, "animal")
centered_barplot(categories, "animal")
centered_barplot(categories3, "animal")
